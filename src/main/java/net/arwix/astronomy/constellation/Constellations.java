package net.arwix.astronomy.constellation;

/**
 * Identification of a Constellation From Position  (Roman 1987)
 * http://vizier.u-strasbg.fr/viz-bin/VizieR?-source=VI/42
 * <p/>
 * Каталог границ созвездий
 */
public class Constellations {

    private static final String[] cns_namemap = {
            "And",
            "Ant",
            "Aps",
            "Aql",
            "Aqr",
            "Ara",
            "Ari",
            "Aur",
            "Boo",
            "CMa",
            "CMi",
            "CVn",
            "Cae",
            "Cam",
            "Cap",
            "Car",
            "Cas",
            "Cen",
            "Cep",
            "Cet",
            "Cha",
            "Cir",
            "Cnc",
            "Col",
            "Com",
            "CrA",
            "CrB",
            "Crt",
            "Cru",
            "Crv",
            "Cyg",
            "Del",
            "Dor",
            "Dra",
            "Equ",
            "Eri",
            "For",
            "Gem",
            "Gru",
            "Her",
            "Hor",
            "Hya",
            "Hyi",
            "Ind",
            "LMi",
            "Lac",
            "Leo",
            "Lep",
            "Lib",
            "Lup",
            "Lyn",
            "Lyr",
            "Men",
            "Mic",
            "Mon",
            "Mus",
            "Nor",
            "Oct",
            "Oph",
            "Ori",
            "Pav",
            "Peg",
            "Per",
            "Phe",
            "Pic",
            "PsA",
            "Psc",
            "Pup",
            "Pyx",
            "Ret",
            "Scl",
            "Sco",
            "Sct",
            "Ser1",
            "Sex",
            "Sge",
            "Sgr",
            "Tau",
            "Tel",
            "TrA",
            "Tri",
            "Tuc",
            "UMa",
            "UMi",
            "Vel",
            "Vir",
            "Vol",
            "Vul",
            "Ser2"};

    private static final int[] cbound = {
            // в минутах дуги
            0, 43200, 5280, 83, 14400, 26100, 5190, 83, 37800, 41400, 5170, 83,
            32400, 37800, 5160, 83, 0, 14400, 5100, 18, 16500, 19200, 4920, 13,
            0, 9000, 4800, 18, 19200, 26100, 4800, 13, 31500, 32400, 4800, 83,
            36300, 37800, 4800, 33, 0, 6315, 4620, 18, 20700, 24450, 4620, 13,
            29760, 31500, 4500, 83, 36300, 37200, 4500, 18, 14340, 16500, 4410, 13,
            16500, 20400, 4410, 33, 23400, 29760, 4200, 83, 5580, 6150, 4080, 16,
            36750, 37200, 4020, 33, 20400, 21600, 3990, 33, 0, 600, 3960, 18,
            25200, 28200, 3960, 83, 42450, 43200, 3960, 18, 21600, 24300, 3840, 33,
            24300, 25950, 3780, 33, 41700, 42450, 3780, 18, 10980, 12600, 3720, 13,
            36000, 36750, 3690, 33, 36966, 37080, 3655, 18, 12600, 14340, 3600, 13,
            14340, 15150, 3600, 82, 35580, 36000, 3570, 33, 36000, 36966, 3570, 18,
            41160, 41700, 3545, 18, 0, 4380, 3510, 16, 34950, 35580, 3480, 33,
            3060, 3435, 3450, 16, 4380, 5580, 3420, 16, 5580, 5700, 3420, 13,
            40170, 41160, 3375, 18, 9000, 10980, 3360, 13, 25260, 25950, 3330, 82,
            25950, 34950, 3330, 33, 5700, 6000, 3300, 13, 39840, 40170, 3300, 18,
            37080, 39540, 3290, 18, 0, 3060, 3240, 16, 10980, 11700, 3240, 50,
            21750, 24300, 3180, 82, 27450, 28350, 3180, 33, 39540, 39840, 3165, 18,
            6000, 9000, 3150, 13, 41160, 42000, 3150, 16, 28350, 30600, 3090, 33,
            3675, 4530, 3030, 62, 30600, 32820, 3030, 33, 0, 2460, 3000, 16,
            2460, 3000, 3000, 62, 11700, 12240, 3000, 50, 42000, 43200, 3000, 16,
            24300, 25260, 2910, 82, 0, 2010, 2880, 16, 42450, 43200, 2880, 16,
            32715, 32820, 2850, 39, 32820, 34350, 2850, 33, 34350, 34500, 2850, 30,
            3000, 3675, 2820, 62, 15150, 16500, 2820, 82, 300, 1560, 2760, 16,
            21600, 21750, 2700, 82, 12240, 13260, 2670, 50, 39435, 39540, 2640, 30,
            39375, 39435, 2625, 30, 34500, 34920, 2610, 30, 16500, 18300, 2520, 82,
            18300, 19410, 2400, 82, 27780, 28350, 2400, 8, 28350, 29400, 2400, 39,
            16650, 17250, 2385, 50, 0, 4530, 2205, 0, 4530, 4620, 2205, 62,
            34845, 34920, 2190, 51, 8100, 8445, 2160, 62, 39120, 39375, 2160, 30,
            39375, 39600, 2160, 45, 11760, 13260, 2130, 7, 13260, 13950, 2130, 50,
            0, 3600, 2100, 0, 39600, 41070, 2100, 45, 41070, 41160, 2070, 45,
            41160, 42300, 2070, 0, 4620, 4890, 2040, 62, 19410, 19800, 2040, 82,
            21600, 22200, 2040, 11, 13950, 16650, 2010, 50, 16650, 17790, 2010, 44,
            1290, 2535, 1980, 0, 27330, 27780, 1980, 8, 42300, 42750, 1925, 0,
            22200, 23850, 1920, 11, 42750, 43200, 1880, 0, 25125, 25260, 1845, 11,
            4350, 4890, 1840, 80, 4890, 8100, 1840, 62, 8100, 8550, 1800, 7,
            32715, 34845, 1800, 51, 19800, 21600, 1740, 82, 35400, 37650, 1740, 30,
            8550, 10590, 1710, 7, 17790, 18900, 1710, 44, 23850, 25125, 1710, 11,
            0, 120, 1680, 0, 2535, 3000, 1680, 80, 10590, 11760, 1680, 7,
            14190, 14400, 1680, 37, 37650, 39120, 1680, 30, 34665, 35400, 1650, 30,
            3450, 4350, 1635, 80, 29100, 29400, 1620, 26, 27150, 27330, 1560, 8,
            27330, 29100, 1560, 26, 33060, 33960, 1560, 51, 19350, 19800, 1530, 44,
            33960, 34665, 1530, 51, 3000, 3450, 1500, 80, 1290, 1530, 1425, 66,
            18900, 19350, 1410, 44, 38250, 38550, 1410, 87, 10260, 10590, 1370, 77,
            120, 255, 1320, 0, 28650, 28860, 1320, 73, 10590, 11190, 1290, 37,
            35700, 36450, 1275, 87, 33960, 34650, 1265, 87, 255, 1530, 1260, 0,
            36450, 37020, 1230, 87, 14055, 14190, 1200, 37, 37020, 38250, 1170, 87,
            34650, 35700, 1150, 87, 5910, 6060, 1140, 6, 33960, 34200, 1110, 75,
            10260, 10380, 1080, 59, 11190, 11355, 1050, 37, 34200, 35700, 970, 75,
            8940, 9600, 960, 77, 28650, 28950, 960, 39, 35700, 36450, 945, 75,
            8310, 8940, 930, 77, 9600, 10080, 930, 77, 23100, 24300, 900, 24,
            31050, 32850, 860, 39, 21360, 23100, 840, 24, 13500, 14055, 810, 37,
            30150, 31050, 770, 39, 0, 255, 750, 61, 10080, 10380, 750, 77,
            12600, 13500, 750, 37, 38010, 38400, 750, 61, 11355, 12480, 720, 37,
            32850, 33960, 720, 39, 37575, 37890, 710, 31, 37890, 38010, 710, 61,
            20730, 21360, 660, 46, 11235, 11355, 600, 59, 12480, 12600, 600, 37,
            14055, 14265, 600, 22, 42900, 43200, 600, 61, 3000, 5910, 595, 6,
            36255, 36540, 510, 31, 24300, 27150, 480, 8, 40950, 42900, 450, 61,
            14265, 16650, 420, 22, 16650, 19350, 420, 46, 32850, 33592, 375, 58,
            33592, 33960, 375, 3, 37500, 37575, 360, 31, 12600, 12630, 330, 10,
            32850, 33165, 270, 88, 28950, 30150, 240, 39, 32850, 33165, 180, 58,
            38640, 39000, 165, 61, 0, 3600, 120, 66, 33450, 33960, 120, 88,
            36540, 37500, 120, 31, 37500, 38400, 120, 34, 38400, 38640, 120, 61,
            39600, 40950, 120, 61, 39000, 39600, 105, 61, 12630, 12960, 90, 10,
            6450, 8310, 0, 77, 8310, 8400, 0, 59, 12960, 14550, 0, 10,
            26400, 27150, 0, 85, 32100, 32850, 0, 58, 4770, 5910, -105, 19,
            5910, 6450, -105, 77, 27150, 29280, -195, 73, 8400, 9150, -240, 59,
            10500, 11235, -240, 59, 32100, 32340, -240, 88, 32850, 33450, -240, 88,
            33450, 33960, -240, 3, 40950, 42900, -240, 66, 19350, 20730, -360, 46,
            20730, 21300, -360, 85, 0, 600, -420, 66, 42900, 43200, -420, 66,
            25650, 26400, -480, 85, 28650, 29280, -480, 58, 36000, 36960, -540, 3,
            38400, 39360, -540, 4, 30900, 32340, -600, 58, 10500, 14550, -660, 54,
            8850, 9150, -660, 35, 9150, 10500, -660, 59, 14550, 15060, -660, 41,
            17250, 19350, -660, 74, 21300, 23100, -660, 85, 31650, 31800, -700, 58,
            33960, 36000, -722, 3, 8700, 8850, -870, 35, 36960, 38400, -900, 4,
            30900, 32850, -960, 88, 32850, 33960, -960, 72, 15060, 15450, -1020, 41,
            29280, 29475, -1095, 58, 15450, 16350, -1140, 41, 19350, 19500, -1140, 27,
            29280, 29475, -1155, 71, 28200, 28650, -1200, 48, 22650, 23100, -1320, 29,
            23100, 25650, -1320, 85, 16350, 17550, -1440, 41, 3000, 4770, -1463, 19,
            4770, 6750, -1463, 35, 19500, 21300, -1470, 27, 21300, 22650, -1470, 29,
            25650, 26850, -1470, 48, 29280, 30150, -1475, 58, 0, 3000, -1530, 19,
            38400, 39360, -1530, 14, 39360, 42900, -1530, 4, 42900, 43200, -1530, 19,
            17550, 18450, -1590, 41, 8460, 8700, -1635, 35, 8700, 11010, -1635, 47,
            36000, 38400, -1680, 14, 18450, 19050, -1750, 41, 22650, 26850, -1770, 41,
            26850, 28200, -1770, 48, 28200, 28800, -1770, 71, 8250, 8460, -1800, 35,
            30150, 31680, -1800, 58, 31680, 32100, -1800, 76, 19050, 19500, -1870, 41,
            11010, 13260, -1980, 9, 22050, 22650, -1980, 41, 19500, 22050, -2100, 41,
            6300, 6750, -2160, 36, 15060, 16860, -2205, 68, 7680, 8250, -2220, 35,
            32100, 34500, -2220, 76, 38400, 41400, -2220, 65, 41400, 42000, -2220, 70,
            5400, 6300, -2375, 36, 16860, 19800, -2385, 1, 0, 3000, -2400, 70,
            3000, 5400, -2400, 36, 6960, 7680, -2400, 35, 42000, 43200, -2400, 70,
            25500, 26850, -2520, 17, 28200, 28800, -2520, 49, 28800, 29557, -2520, 71,
            8700, 9000, -2580, 12, 9000, 11850, -2580, 23, 14400, 15060, -2580, 67,
            6150, 6960, -2640, 35, 29557, 32100, -2730, 71, 32100, 34500, -2730, 25,
            34500, 36600, -2730, 76, 36600, 38400, -2730, 53, 5400, 6150, -2760, 35,
            8100, 8700, -2790, 12, 27600, 28200, -2880, 49, 0, 4200, -2890, 63,
            4800, 5400, -2940, 35, 7350, 7680, -2940, 40, 7680, 8100, -2940, 12,
            38400, 39600, -3000, 38, 10800, 14400, -3045, 67, 14400, 14700, -3045, 84,
            4350, 4800, -3060, 35, 6900, 7350, -3060, 40, 0, 3300, -3090, 63,
            10800, 11100, -3150, 15, 14700, 15210, -3180, 84, 6300, 6900, -3190, 40,
            6900, 7200, -3190, 32, 0, 2850, -3210, 63, 3900, 4350, -3240, 35,
            8100, 9000, -3240, 64, 27090, 27600, -3240, 49, 15210, 15900, -3270, 84,
            11100, 11700, -3300, 15, 21300, 23100, -3300, 17, 25500, 27090, -3300, 49,
            27090, 27600, -3300, 56, 7200, 7800, -3390, 32, 15900, 19800, -3390, 84,
            19800, 20250, -3390, 17, 31500, 32400, -3420, 5, 32400, 36600, -3420, 78,
            39600, 42000, -3420, 38, 5760, 6300, -3450, 40, 9000, 9900, -3450, 64,
            11700, 12300, -3480, 15, 0, 2400, -3510, 63, 2400, 3900, -3510, 35,
            42000, 43200, -3510, 63, 7800, 8250, -3540, 32, 27600, 29557, -3600, 56,
            36600, 38400, -3600, 43, 9900, 10800, -3660, 64, 27300, 27600, -3660, 21,
            29557, 29850, -3660, 5, 26850, 27300, -3815, 21, 29850, 30150, -3815, 5,
            10800, 12300, -3840, 64, 12300, 16260, -3840, 15, 20250, 21300, -3840, 17,
            21300, 23100, -3840, 28, 23100, 26160, -3840, 17, 24300, 24600, -3900, 21,
            30150, 30300, -3900, 5, 3900, 5760, -4050, 40, 5760, 8250, -4050, 69,
            26550, 26850, -4050, 21, 30300, 31500, -4050, 5, 31500, 32400, -4050, 60,
            39600, 42000, -4050, 81, 8250, 11850, -4200, 32, 24600, 26550, -4200, 21,
            26550, 30600, -4200, 79, 0, 2400, -4500, 81, 6300, 8250, -4500, 42,
            11850, 16260, -4500, 86, 16260, 20250, -4500, 15, 20250, 24600, -4500, 55,
            32400, 38400, -4500, 60, 38400, 42000, -4500, 43, 42000, 43200, -4500, 81,
            1350, 2400, -4560, 81, 0, 6300, -4950, 42, 13800, 24600, -4950, 20,
            24600, 32400, -4950, 2, 6300, 13800, -5100, 52, 0, 43200, -5400, 57};

    private static final int[] start = {
            355, 352, 343, 340, 332, 320, 303, 288, 277, 266, 257, 251,
            239, 229, 221, 211, 203, 189, 177, 163, 149, 136, 124, 104,
            87, 75, 69, 54, 43, 29, 23, 16, 12, 6, 4, 0, 0};

    public static String cns_pick(double al_1875, double de_1875) {
        double ra = Math.floor(al_1875 * 180.0 / Math.PI / 15.0 * 1800.0); // прямое восхождение
        double de = Math.floor(de_1875 * 180.0 / Math.PI * 60.0); // склонение
        int i = (int) Math.floor((de + 5400.0) / 300.0);
        if (i < 0 || i > 36) return null;
        i = start[i];
        for (i = 0; i < cbound.length / 4; i++) {
            // склонение меньше чем 3 столбец
            // восхождение больше чем 2 стлбец
            // восхождение меньше чем 1 столбец
            if (cbound[i * 4 + 2] <= de && cbound[i * 4 + 1] > ra && cbound[i * 4] <= ra) break;
        }
        int icon = (int) ((i == 357) ? -1 : Math.floor(cbound[i * 4 + 3]));
        if (icon == -1) return null;
        return (cns_namemap[icon]);
    }

    public static int cns_pick_int(double al_1875, double de_1875) {
        double ra = Math.floor(al_1875 * 180.0 / Math.PI / 15.0 * 1800.0); // прямое восхождение
        double de = Math.floor(de_1875 * 180.0 / Math.PI * 60.0); // склонение
        int i = (int) Math.floor((de + 5400.0) / 300.0);
        if (i < 0 || i > 36) return -1;
        i = start[i];
        for (i = 0; i < cbound.length / 4; i++) {
            // склонение меньше чем 3 столбец
            // восхождение больше чем 2 стлбец
            // восхождение меньше чем 1 столбец
            if (cbound[i * 4 + 2] <= de && cbound[i * 4 + 1] > ra && cbound[i * 4] <= ra) break;
        }
        int icon = (int) ((i == 357) ? -1 : Math.floor(cbound[i * 4 + 3]));
        //	if (icon == -1) return null;
        return icon;
    }


}